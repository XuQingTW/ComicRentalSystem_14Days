B11170075陳泓維
B11170047陳家龢

# 漫畫租借管理系統 (Comic Rental System)

## 功能特色

本系統提供兩種使用者角色：管理員 (系統管理員) 和會員 (一般使用者)，各自擁有不同的操作權限。

### 管理員 (系統管理員)

管理員登入後，主介面左側提供快速導覽面板，可存取儀表板、漫畫管理、會員管理、租借管理、使用者註冊及日誌管理等功能。

*   **漫畫管理與狀態檢視**：
    *   **主介面漫畫狀態總覽**：登入後，管理員主介面會顯示所有漫畫的詳細狀態列表。此列表包含書名、作者、目前狀態（例如「被借閱」、「在館中」）、借閱者資訊（若已租借）、租借日期及預計歸還日期。
        *   可依「全部」、「已租借」、「可租借」狀態篩選漫畫列表。
        *   列表支援點擊欄位標頭進行排序。
    *   **漫畫資料編輯**：透過頂部選單「管理」->「漫畫管理」或主導覽面板「漫畫管理」可開啟專用視窗，進行新增、編輯和刪除漫畫資料等操作。管理員可為漫畫新增或更換封面圖片。編輯漫畫時，若漫畫原為租借狀態，管理員可手動將其標記為歸還（清除租借者資訊與租借日期）。
    *   **查詢漫畫**：在漫畫管理視窗或主介面狀態總覽中，可依書名、作者、ISBN、類型等條件查詢漫畫。
    *   **Admin Dashboard (管理員儀表板)**：管理員登入後預設顯示的或可透過主導覽按鈕存取的儀表板。它提供系統的即時概覽，例如漫畫總數、已租借數量、可租借數量、會員數等關鍵統計數據。
*   **會員管理**：
    *   新增、編輯和刪除會員資料。
    *   查詢會員（可依姓名、電話號碼、使用者名稱等多個欄位進行搜尋）。
    *   注意：無法刪除仍有未歸還漫畫的會員。
*   **使用者帳號管理**：
    *   註冊新的使用者帳號，並可指定其角色為管理員或會員。
    *   刪除現有的使用者帳號（為確保系統正常運作，無法刪除最後一位管理員帳號）。
    *   **帳號鎖定 (Account Lockout)**：為提升安全性，在連續多次（例如 5 次）登入失敗後，帳號將被暫時鎖定（例如 15 分鐘）。
*   **租借流程管理**：
    *   透過租借表單協助會員完成漫畫的租借與歸還流程。
    *   管理員可查看所有漫畫的當前租借狀態（已整合至主介面漫畫狀態總覽）。
    *   在租借管理介面，管理員為會員辦理租借時，可篩選特定會員以檢視其當前租借狀況（如有）或直接為其辦理新的租借。
*   **日誌管理與檢視**：
    *   **開啟日誌目錄**：可透過頂部選單「工具」->「檢視日誌」選單快速開啟儲存日誌檔案的資料夾。
    *   **日誌管理介面**：可透過頂部選單「工具」->「日誌管理」選單，或主導覽面板「日誌管理」，開啟專用介面來檢視特定日誌內容或管理日誌設定（如保留天數）。

### 會員 (一般使用者)

會員登入後，主介面主要分為「可租借漫畫」及「我的租借」兩個標籤頁，方便切換檢視。

*   **瀏覽與搜尋漫畫**：
    *   在「可租借漫畫」標籤頁中，查看系統中所有可供租借的漫畫列表。
    *   可依書名、作者進行搜尋，亦可依漫畫「類型」篩選可租借的漫畫列表，快速找到感興趣的漫畫。
    *   封面圖片顯示：可租借的漫畫列表會顯示漫畫的封面圖片（若已提供），讓瀏覽更加直觀。
*   **檢視個人租借狀態**：
    *   在「我的租借」標籤頁中，查看自己當前已租借的所有漫畫。
    *   清楚了解每本租借漫畫的租借起始日期及預計歸還日期。
    *   系統會透過顏色標記（例如，紅色表示逾期，黃色表示即將到期）及狀態文字，在「我的租借」列表中提示即將到期或已逾期的漫畫。

## 技術棧

*   **程式語言：** C#
*   **框架/平台：** .NET Windows Forms
*   **資料儲存：**
    *   使用 SQLite 資料庫 (`comic_rental.db`) 儲存所有應用程式資料，包括漫畫、會員和使用者帳號。
    *   資料庫檔案預設位於程式執行檔所在目錄的 `comic_rental.db` 檔案中，即與應用程式可執行檔同層。
    *   本專案使用 Entity Framework Core 作為 ORM (Object-Relational Mapper) 來進行資料庫操作。
*   **日誌記錄：**
    *   日誌檔案儲存在使用者「我的文件」資料夾內的 `ComicRentalApp\Logs` 目錄下 (例如：`C:\Users\YourUsername\Documents\ComicRentalApp\Logs`)。
    *   系統會每日建立新的日誌檔案，檔案命名格式為 `yyyyMMdd.txt` (例如 `20231026.txt`)。
    *   日誌保留政策預設為 90 天。超過保留期限的日誌檔案將會被備份（如果需要）然後自動刪除，以節省儲存空間。
*   **資料遷移與初始設定 (Data Migration & Initial Setup):**
    *   系統在首次啟動時，若偵測到特定格式的 CSV 或 JSON 檔案 (例如 `comics.csv`, `members.csv`, `users.json`) 於應用程式特定目錄下 (通常為執行檔同目錄下的 `Data` 資料夾)，且資料庫為空，會嘗試自動匯入初始漫畫、會員與使用者資料。
    *   系統在首次啟動或找不到任何管理員帳號時，會自動建立一個預設管理員帳號（詳見安裝與啟動）。


## 系統需求

*   **作業系統：** Windows (本專案為 Windows Forms 應用程式)
*   **.NET 環境：** .NET 8.0 Runtime (或更高相容版本)

## 安裝與啟動

1.  **取得專案：**
    *   您可以透過 Git clone 指令從版本控制庫下載本專案：
        ```bash
        git clone <repository_url>
        ```
        (請將 `<repository_url>` 替換為實際的倉儲網址)
    *   或者，直接下載專案的 ZIP 壓縮檔並解壓縮。

2.  **編譯與執行：**
    *   開啟 Visual Studio (建議使用 Visual Studio 2022 或更新版本)。
    *   選擇「開啟專案或解決方案」，並選取專案根目錄下的 `ComicRentalSystem_14Days.sln` 檔案。
    *   等待 Visual Studio 還原 NuGet 套件。
    *   點擊工具列上的「開始」按鈕 (或按 F5) 編譯並執行專案。
    *   應用程式將會啟動並顯示登入視窗。

3.  **預設管理員帳號：**
    *   系統在首次啟動或找不到任何管理員帳號時，會自動建立一個預設管理員帳號：
        *   **使用者名稱：** `admin`
        *   **密碼：** `admin123`
    *   建議首次登入後立即更改管理員密碼。

4.  **資料與日誌檔案路徑說明：**
    *   **資料庫檔案**：
        *   `comic_rental.db`：包含所有應用程式資料 (漫畫、會員、使用者帳號等)。
        *   此檔案預設位於程式資料夾根目錄，即與應用程式執行檔同層的 `comic_rental.db`。
        *   亦可透過環境變數 `COMIC_DB_PATH` 指定其他資料庫檔案路徑。
        *   如果此資料庫檔案在應用程式首次執行時不存在，系統將會自動建立它。
    *   **日誌檔案目錄**：
        *   日誌檔案 (例如 `20231026.txt`) 儲存在使用者「我的文件」資料夾內的 `ComicRentalApp\Logs` 目錄下 (例如：`C:\Users\YourUsername\Documents\ComicRentalApp\Logs`)。
    *   請確保應用程式對上述指定的目錄具有讀寫權限。

## 使用教學

### 1. 登入系統

*   啟動應用程式後，會首先看到登入視窗。
*   輸入您的使用者名稱和密碼。
*   若是首次使用，請使用預設管理員帳號 (`admin` / `admin123`) 登入。
*   登入成功後，系統會根據您的角色（管理員或會員）顯示對應的主介面。

### 2. 管理員操作

管理員登入後，主介面左側提供快速導覽面板，可存取儀表板、漫畫管理(狀態總覽模式)、會員管理、租借管理、使用者註冊及日誌管理等功能。頂部選單則提供部分功能的直接入口（如漫畫資料編輯、會員資料編輯等）。

*   **漫畫狀態檢視與管理：**
    *   **檢視漫畫狀態 (主介面/導覽面板「漫畫管理」)**：管理員登入後，主介面預設或透過導覽面板「漫畫管理」可進入所有漫畫的詳細狀態列表。您可以透過此列表查看每本漫畫的當前租借狀態、租借者、到期日等，並可使用狀態篩選器（如「已租借」、「可租借」）及點擊欄位標頭進行排序。
    *   **編輯漫畫資料 (漫畫管理視窗)**：若要新增、修改或刪除漫畫資料（包含封面圖片），請透過頂部選單「管理」->「漫畫管理」開啟漫畫管理視窗。在此視窗中進行相關操作。
*   **會員管理：**
    *   可透過頂部選單「管理」->「會員管理」或主導覽面板「會員管理」開啟會員管理視窗。
    *   在此視窗中，您可以新增會員、選取列表中的會員進行編輯或刪除。
*   **使用者註冊：**
    *   可透過頂部選單「使用者註冊 (&R)」或主導覽面板「使用者註冊」開啟使用者註冊視窗，以新增管理員或會員帳號。
*   **處理漫畫租借與歸還 (租借表單)：**
    *   可透過頂部選單「管理」->「租借管理」或主導覽面板「租借管理」開啟租借表單。
    *   **租借漫畫給會員：** 在此表單中，選擇會員，然後選擇該會員要租借的漫畫，設定租借期限後即可完成租借。
    *   **處理會員歸還漫畫：** 在此表單中，找到已租借的漫畫，執行歸還操作，漫畫狀態將更新為可租借。
*   **檢視與管理日誌：**
    *   **開啟日誌資料夾：** 可透過頂部選單「工具」->「檢視日誌」直接開啟存放日誌檔案的資料夾，方便存取所有日誌檔。
    *   **使用日誌管理介面：** 可透過頂部選單「工具」->「日誌管理」或主導覽面板「日誌管理」開啟日誌管理視窗。此視窗可能提供檢視單個日誌檔案內容、設定日誌保留期限等功能。

### 3. 會員操作

登入會員帳號後，主介面會以標籤頁形式顯示「可租借漫畫」以及「我的租借」。

*   **瀏覽與搜尋漫畫：**
    *   在「可租借漫畫」標籤頁中，您可以看到所有目前可租借的漫畫，包含封面、書名、作者、類型等資訊。
    *   可以使用上方的搜尋框（依書名/作者）或「類型」下拉式選單來篩選並尋找特定漫畫。
*   **檢視我的租借：**
    *   切換到「我的租借」標籤頁。
    *   這裡會列出您所有已租借的漫畫、租借日期以及預計歸還日期。
    *   系統會透過顏色標記（例如，紅色表示逾期，黃色表示即將到期）及狀態文字，在「我的租借」列表中提示即將到期或已逾期的漫畫，提醒您及時歸還。
*   **歸還漫畫：**
    *   會員需聯繫管理員協助處理漫畫歸還事宜。管理員會使用系統中的租借管理功能來更新漫畫的狀態。
